# Comparing `tmp/siat-1.9.7-py3-none-any.whl.zip` & `tmp/siat-2.0-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,8 +1,8 @@
-Zip file size: 1127612 bytes, number of entries: 117
+Zip file size: 1131093 bytes, number of entries: 117
 -rw-rw-rw-  2.0 fat      840 b- defN 23-Apr-10 11:29 siat/__init__.py
 -rw-rw-rw-  2.0 fat     2130 b- defN 23-Apr-10 11:29 siat/allin.py
 -rw-rw-rw-  2.0 fat      747 b- defN 23-Apr-10 11:29 siat/alpha_vantage_test.py
 -rw-rw-rw-  2.0 fat    28555 b- defN 23-Apr-10 11:29 siat/assets_liquidity.py
 -rw-rw-rw-  2.0 fat     1285 b- defN 23-Apr-10 11:29 siat/assets_liquidity_test.py
 -rw-rw-rw-  2.0 fat    10110 b- defN 23-Apr-10 11:29 siat/barrons_scraping_test.py
 -rw-rw-rw-  2.0 fat    36597 b- defN 23-Apr-10 11:29 siat/beta_adjustment.py
@@ -31,15 +31,15 @@
 -rw-rw-rw-  2.0 fat     2944 b- defN 23-Apr-10 11:29 siat/esg_test.py
 -rw-rw-rw-  2.0 fat    47177 b- defN 23-Apr-10 11:29 siat/fama_french.py
 -rw-rw-rw-  2.0 fat     4678 b- defN 23-Apr-10 11:29 siat/fama_french_test.py
 -rw-rw-rw-  2.0 fat    40695 b- defN 23-Apr-10 11:29 siat/financial_base.py
 -rw-rw-rw-  2.0 fat    21528 b- defN 23-Apr-10 11:29 siat/financial_statements.py
 -rw-rw-rw-  2.0 fat      716 b- defN 23-Apr-10 11:29 siat/financial_statements_test.py
 -rw-rw-rw-  2.0 fat    76676 b- defN 23-Apr-10 11:29 siat/financials.py
--rw-rw-rw-  2.0 fat   149838 b- defN 23-Apr-23 04:43 siat/financials_china.py
+-rw-rw-rw-  2.0 fat   173655 b- defN 23-May-03 11:53 siat/financials_china.py
 -rw-rw-rw-  2.0 fat    60037 b- defN 23-Apr-23 05:59 siat/financials_china2.py
 -rw-rw-rw-  2.0 fat     2722 b- defN 23-Apr-10 11:29 siat/financials_china2_test.py
 -rw-rw-rw-  2.0 fat     3507 b- defN 23-Apr-10 11:29 siat/financials_china2_test2.py
 -rw-rw-rw-  2.0 fat     3118 b- defN 23-Apr-10 11:29 siat/financials_china2_test3.py
 -rw-rw-rw-  2.0 fat    17549 b- defN 23-Apr-10 11:29 siat/financials_china_test.py
 -rw-rw-rw-  2.0 fat     5924 b- defN 23-Apr-19 09:54 siat/financials_china_test2.py
 -rw-rw-rw-  2.0 fat     5924 b- defN 23-Apr-19 09:55 siat/financials_china_test2_fin_indicator.py
@@ -75,15 +75,15 @@
 -rw-rw-rw-  2.0 fat     1552 b- defN 23-Apr-10 11:29 siat/quandl_test.py
 -rw-rw-rw-  2.0 fat    49073 b- defN 23-Apr-10 11:29 siat/risk_adjusted_return.py
 -rw-rw-rw-  2.0 fat     3416 b- defN 23-Apr-10 11:29 siat/risk_adjusted_return_test.py
 -rw-rw-rw-  2.0 fat    75061 b- defN 23-Apr-10 11:29 siat/risk_evaluation.py
 -rw-rw-rw-  2.0 fat     3731 b- defN 23-Apr-10 11:29 siat/risk_evaluation_test.py
 -rw-rw-rw-  2.0 fat    12304 b- defN 23-Apr-10 11:29 siat/risk_free_rate.py
 -rw-rw-rw-  2.0 fat     4285 b- defN 23-Apr-10 11:29 siat/risk_free_rate_test.py
--rw-rw-rw-  2.0 fat    99980 b- defN 23-Apr-23 00:56 siat/sector_china.py
+-rw-rw-rw-  2.0 fat   100084 b- defN 23-May-04 05:22 siat/sector_china.py
 -rw-rw-rw-  2.0 fat     5843 b- defN 23-Apr-11 14:17 siat/sector_china_test.py
 -rw-rw-rw-  2.0 fat    29148 b- defN 23-Apr-10 11:29 siat/security_price.py
 -rw-rw-rw-  2.0 fat    71984 b- defN 23-Apr-10 11:29 siat/security_prices.py
 -rw-rw-rw-  2.0 fat    10779 b- defN 23-Apr-10 11:29 siat/security_prices_test.py
 -rw-rw-rw-  2.0 fat     1335 b- defN 23-Apr-10 11:29 siat/setup.py
 -rw-rw-rw-  2.0 fat     1418 b- defN 23-Apr-10 11:29 siat/shenwan index history test.py
 -rw-rw-rw-  2.0 fat   117254 b- defN 23-Apr-10 11:29 siat/stock.py
@@ -108,12 +108,12 @@
 -rw-rw-rw-  2.0 fat   118133 b- defN 23-Apr-10 11:29 siat/translate-20230206.py
 -rw-rw-rw-  2.0 fat   121657 b- defN 23-Apr-10 11:29 siat/translate-20230215.py
 -rw-rw-rw-  2.0 fat   124748 b- defN 23-Apr-19 09:58 siat/translate.py
 -rw-rw-rw-  2.0 fat     3936 b- defN 23-Apr-10 11:29 siat/universal_test.py
 -rw-rw-rw-  2.0 fat    51268 b- defN 23-Apr-10 11:29 siat/valuation_china.py
 -rw-rw-rw-  2.0 fat     1571 b- defN 23-Apr-10 11:29 siat/valuation_market_china_test.py
 -rw-rw-rw-  2.0 fat    14859 b- defN 23-Apr-10 11:29 siat/var_model_validation.py
--rw-rw-rw-  2.0 fat     1399 b- defN 23-Apr-23 06:01 siat-1.9.7.dist-info/METADATA
--rw-rw-rw-  2.0 fat       92 b- defN 23-Apr-23 06:01 siat-1.9.7.dist-info/WHEEL
--rw-rw-rw-  2.0 fat        5 b- defN 23-Apr-23 06:01 siat-1.9.7.dist-info/top_level.txt
-?rw-rw-r--  2.0 fat     9353 b- defN 23-Apr-23 06:01 siat-1.9.7.dist-info/RECORD
-117 files, 4434377 bytes uncompressed, 1113342 bytes compressed:  74.9%
+-rw-rw-rw-  2.0 fat     1397 b- defN 23-May-07 12:23 siat-2.0.dist-info/METADATA
+-rw-rw-rw-  2.0 fat       92 b- defN 23-May-07 12:23 siat-2.0.dist-info/WHEEL
+-rw-rw-rw-  2.0 fat        5 b- defN 23-May-07 12:23 siat-2.0.dist-info/top_level.txt
+?rw-rw-r--  2.0 fat     9346 b- defN 23-May-07 12:23 siat-2.0.dist-info/RECORD
+117 files, 4458289 bytes uncompressed, 1116839 bytes compressed:  75.0%
```

## zipnote {}

```diff
@@ -333,20 +333,20 @@
 
 Filename: siat/valuation_market_china_test.py
 Comment: 
 
 Filename: siat/var_model_validation.py
 Comment: 
 
-Filename: siat-1.9.7.dist-info/METADATA
+Filename: siat-2.0.dist-info/METADATA
 Comment: 
 
-Filename: siat-1.9.7.dist-info/WHEEL
+Filename: siat-2.0.dist-info/WHEEL
 Comment: 
 
-Filename: siat-1.9.7.dist-info/top_level.txt
+Filename: siat-2.0.dist-info/top_level.txt
 Comment: 
 
-Filename: siat-1.9.7.dist-info/RECORD
+Filename: siat-2.0.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## siat/financials_china.py

```diff
@@ -54,14 +54,16 @@
     akfs=get_fin_stmt_ak(ticker)
     
 def get_fin_stmt_ak(ticker):
     """
     从akshare获取财务报表数据，合成df，限于中国A股
     获取的项目：所有原始项目
     注意：抓取所有的报表，不过滤日期
+    
+    注意：需要akshare版本1.9.59及以上，字段有变化
     """
     print("  Searching financial statements for",ticker,"...")
     #是否中国股票
     result,prefix,suffix=split_prefix_suffix(ticker)
     if not (suffix in STOCK_SUFFIX_CHINA):
         print("  #Error(get_fin_stmt_ak): not a stock in China",ticker)
         return None        
@@ -107,21 +109,27 @@
     
     fis1=fis.drop_duplicates(subset=[rptdate],keep='first')
     fis1.sort_values(by=[rptdate],ascending=True,inplace=True)
     fis1['date']=pd.to_datetime(fis1[rptdate])
     fis1.set_index('date',inplace=True)
     
     dropcollist=['报告日','数据源','公告日期','更新日期']
-    fis1.drop(labels=dropcollist,axis=1,inplace=True)
+    try:
+        fis1.drop(labels=dropcollist,axis=1,inplace=True)
+    except:
+        pass
     
     fcf1=fcf.drop_duplicates(subset=[rptdate],keep='first')
     fcf1.sort_values(by=[rptdate],ascending=True,inplace=True)
     fcf1['date']=pd.to_datetime(fcf1[rptdate])
     fcf1.set_index('date',inplace=True)
-    fcf1.drop(labels=dropcollist,axis=1,inplace=True)
+    try:
+        fcf1.drop(labels=dropcollist,axis=1,inplace=True)
+    except:
+        pass
 
     #合成：内连接
     fs1=pd.merge(fbs1,fis1,how='inner',left_index=True,right_index=True)
     fs2=pd.merge(fs1,fcf1,how='inner',left_index=True,right_index=True)
     
     if len(fs2) == 0:
         print("  #Warning(get_fin_stmt_ak): zero reports found for",ticker)
@@ -3124,27 +3132,26 @@
     result=False
     for sub in substrlist:
         if sub in astr:
             result=True
             
     return result
 
-
+#==============================================================================
 if __name__=='__main__':
     ticker='000002.SZ'
     fsdates=['2022-12-31','2021-12-31','2020-12-31']
     
     fsdf1=get_fin_summary_1ticker_china(ticker,fsdates)
 
 def get_fin_summary_1ticker_china(ticker,fsdates):
     """
     功能：获得A股财报摘要，进行数据整理，单一股票
     输出：
-    1、项目列表：不带(元)、(次)、(%)等后缀括弧
-    2、数量级变换：(元)-->(亿元)，并相应修改字段名
+    1、数量级变换：(元)-->(亿元)，并相应修改字段名
     """
 
     import pandas as pd
     # 过滤财报日期
     fsdates2=[]
     for d in fsdates:
         d1=pd.to_datetime(d)
@@ -3250,31 +3257,30 @@
     fsdfm=get_fin_summary_china(tickers,fsdates)
     
 
 def get_fin_summary_china(tickers,fsdates):
     """
     功能：获得A股财报摘要，进行数据整理
     输出：
-    1、项目列表：不带(元)、(次)、(%)等后缀括弧
-    2、数量级变换：(元)-->(亿元)，并相应修改字段名
+    1、数量级变换：(元)-->(亿元)，并相应修改字段名
     """
 
     import pandas as pd
     # 过滤财报日期
     fsdates2=[]
     for d in fsdates:
         d1=pd.to_datetime(d)
         d2=d1.strftime("%Y-%m-%d")
         fsdates2=fsdates2 + [d2]
     fsdates3=list(set(fsdates2))
     fsdates4=sorted(fsdates3,reverse=True)
     
     df=pd.DataFrame()
     
-    # 获得股票
+    # 获得多只股票财报
     for t in tickers:
         # 抓取一只股票的财报
         dft=get_fin_summary_1ticker_china(t,fsdates4)
         if dft is None: 
             continue
         
         if len(df)==0:
@@ -3468,15 +3474,15 @@
             dft.sort_values(by='指标',inplace=True)
             
             dft.reset_index(drop=True,inplace=True)
             dft.index=dft.index + 1
             dft2=dft.drop(labels=['选项','ticker'],axis=1)
             
             print("\n***",ty+'：')
-            colalign=['center','left']+['right']*(len(list(dft2)) - 2)
+            colalign=['center','left']+['right']*(len(list(dft2)) - 1)
             print(dft2.to_markdown(tablefmt='Simple',index=True,colalign=colalign))
             print(notesdict[ty])
             
     
     # 多只股票情形：单日期
     import pandas as pd
     fsdates2=[]
@@ -3514,16 +3520,478 @@
             dft.sort_values(by='指标',inplace=True)
             
             dft.reset_index(drop=True,inplace=True)
             dft.index=dft.index + 1
             dft2=dft.drop(labels=['选项'],axis=1)
             
             print("\n***",ty+'：')
-            colalign=['center','left']+['right']*(len(list(dft2)) - 2)
+            colalign=['center','left']+['right']*(len(list(dft2)) - 1)
             print(dft2.to_markdown(tablefmt='Simple',index=True,colalign=colalign))
             print(notesdict[ty])
     
     return dft2
 
 #==============================================================================
 #==============================================================================
+if __name__=='__main__':
+    ticker='000002.SZ'
+    fsdates=['2022-12-31','2021-12-31','2020-12-31']
+    
+    fsdf1=get_fin_indicator_1ticker_china(ticker,fsdates)
+
+def get_fin_indicator_1ticker_china(ticker,fsdates):
+    """
+    功能：获得A股财报指标，进行数据整理，单一股票
+    输出：
+    1、数量级变换：(元)-->(亿元)，并相应修改字段名
+    """
+
+    import pandas as pd
+    # 过滤财报日期
+    fsdates2=[]
+    for d in fsdates:
+        d1=pd.to_datetime(d)
+        d2=d1.strftime("%Y-%m-%d")
+        fsdates2=fsdates2 + [d2]
+    fsdates3=sorted(fsdates2,reverse=True)
+    
+    # 亿元
+    yiyuan=float(1e+08)
+    
+    # 获得股票所有财报数据
+    _,t1,_=split_prefix_suffix(ticker)
+    dft=ak.stock_financial_analysis_indicator(t1)
+    
+    # 过滤财报日期 
+    fsdate_field=list(dft)[0]
+    dft2=dft[dft[fsdate_field].isin(fsdates3)]
+    if len(dft2) < len(fsdates3):
+        print("  #Warning(get_fin_summary_1ticker_china): fin stmt of some dates unavailable for",ticker+'('+codetranslate(ticker)+')')
+    if len(dft2) ==0:
+        print("  #Error(get_fin_summary_1ticker_china): no fin stmts found for",ticker+'('+codetranslate(ticker)+') on',fsdates)
+        return None
+
+    # 去掉重复行
+    dft2b=dft2.drop_duplicates (keep='first')
+    dft3=dft2b.replace('--',0)
+    
+    # 金额变换：元-->亿元，小数位截取
+    collist3=list(dft3)
+    for c in collist3:
+        c1=c
+        try:
+            dft3[c]=dft3[c].astype(float)
+            if ('元' in c) and not ('每股' in c):
+                dft3[c]=dft3[c] / yiyuan
+                c1=c.replace('元','亿元')
+                dft3.rename(columns={c:c1},inplace=True)
+                
+            if ('比重' in c) and not ('%' in c):
+                c1=c+'(%)'
+                dft3.rename(columns={c:c1},inplace=True)
+                
+            dft3[c1]=dft3[c1].apply(lambda x: round(x,2))   
+        except:
+            pass
+       
+    # 检查字段改名情况
+    collist3b=list(dft3)
+    
+    # 回填指标选项类型
+    dft4=dft3.set_index(fsdate_field)
+    dft4t=dft4.T
+    dft5=dft4t.reset_index()
+    dft5.index=dft5.index + 1
+    dft5.rename(columns={'index':'指标'},inplace=True)
+    
+    # 去重
+    dft5=dft5.drop_duplicates (keep='first')
+    
+    dft5['ticker']=ticker
+        
+    # 填充nan为零
+    dft5.fillna(0,inplace=True)
+    dft5.replace(0,'-',inplace=True)
+    
+    # 指标分类
+    retstrlist=['利润率','毛利率','成本率','净利率','报酬率','比重','股息','收益率','增长率']
+    debtstrlist=['流动比','速动比','现金比','倍数','负债','债务','权益','产权','清算']
+    
+    dft5['选项']=''
+    for index,row in dft5.iterrows():
+        # 改变顺序要谨慎
+        if ('每股' in row['指标']) and (row['选项'] == ''):
+            row['选项']='每股指标'
+            
+        if ('周转' in row['指标']) and (row['选项'] == ''):
+            row['选项']='营运能力'
+            
+        if ('应收' in row['指标']) and (row['选项'] == ''):
+            row['选项']='应收账款'            
+            
+        if ('预付' in row['指标']) and (row['选项'] == ''):
+            row['选项']='预付账款' 
+            
+        if str_contain_any_substr(row['指标'],debtstrlist) and (row['选项'] == ''):
+            row['选项']='偿债能力'      
+            
+        if ('现金' in row['指标']) and (row['选项'] == ''):
+            row['选项']='现金指标'             
+            
+        if ('亿元' in row['指标']) and (row['选项'] == ''):
+            row['选项']='规模指标'                
+            
+        if ('亿元' in row['指标']) and (row['选项'] == ''):
+            row['选项']='规模指标'                 
+            
+        if str_contain_any_substr(row['指标'],retstrlist) and (row['选项'] == ''):
+            row['选项']='利润回报'            
+            
+        if (row['选项'] == ''):
+            row['选项']='其他指标'      
+    
+    return dft5
+
+#==============================================================================
+if __name__=='__main__':
+    tickers=['000002.SZ','601398.SS']
+    fsdates=['2022-12-31','2021-12-31','2020-12-31']
+    
+    fsdfm=get_fin_indicator_china(tickers,fsdates)
+    
+
+def get_fin_indicator_china(tickers,fsdates):
+    """
+    功能：获得A股财报指标，进行数据整理
+    输出：
+    1、数量级变换：(元)-->(亿元)，并相应修改字段名
+    """
+
+    import pandas as pd
+    # 过滤财报日期
+    fsdates2=[]
+    for d in fsdates:
+        d1=pd.to_datetime(d)
+        d2=d1.strftime("%Y-%m-%d")
+        fsdates2=fsdates2 + [d2]
+    fsdates3=list(set(fsdates2))
+    fsdates4=sorted(fsdates3,reverse=True)
+    
+    df=pd.DataFrame()
+    # 获得多只股票财报
+    for t in tickers:
+        # 抓取一只股票的财报
+        dft=get_fin_indicator_1ticker_china(t,fsdates4)
+        if dft is None: 
+            continue
+        
+        if len(df)==0:
+            df=dft
+        else:
+            df=pd.concat([df,dft])
+    
+    return df
+
+#==============================================================================
+
+if __name__=='__main__':
+    tickers=['000002.SZ','601398.SS']
+    fsdates=['2022-12-31','2021-12-31','2020-12-31']
+    
+    tickers=['000002.SZ','600048.SS','001979.SZ','600325.SS','000069.SZ','600383.SS','600895.SS','601155.SS']
+    fidf=compare_fin_indicator_china(tickers,fsdates)
+    
+def compare_fin_indicator_china(tickers,fsdates):
+    """
+    功能：分类别显示财报摘要中的指标
+    """        
+    
+    # 检查股票列表
+    if isinstance(tickers,str):
+        tickers=[tickers]
+    tickers=list(tickers) #强制转换
+    if len(tickers)==0:
+        print("  #Error(compare_fin_summary_china): need at least one stock in",tickers)
+        return None
+    
+    # 检查财报日期列表
+    if isinstance(fsdates,str):
+        fsdates=[fsdates]
+    if len(fsdates)==0:
+        print("  #Error(compare_fin_summary_china): need at least one date in",fsdates)
+        return None
+    
+    for d in fsdates:
+        result,_,_=check_period(d,d)
+        if not result:
+            print("  #Error(compare_fin_summary_china): invalid date",d)
+            return None
+        
+    # 获取财报数据
+    print("Searching for financial statements, please wait ...")
+    fsdf=get_fin_indicator_china(tickers,fsdates)
+    
+    # 不改变列表顺序去重
+    tickerlist=list(fsdf['ticker'])
+    tickers_found=sorted(list(set(tickerlist)),key=tickerlist.index)
+    
+    #optionlist=list(fsdf['选项'])
+    #typelist=sorted(list(set(optionlist)),key=optionlist.index)
+    typelist=['规模指标','利润回报','每股指标','营运能力','现金指标','偿债能力','应收账款','预付账款','其他指标']
+    """
+    # 按照指定的选项顺序排序
+    fsdf['选项'] = fsdf['选项'].astype('category')
+    fsdf['选项'].cat.reorder_categories(typelist, inplace=True)
+    fsdf.sort_values('选项', inplace=True)
+    """
+    """
+    # 列出每个选项的科目
+    fsdf1=fsdf[fsdf['ticker']==tickers[0]]
+    dictlist={}
+    for ty in typelist:
+        tmpdf=fsdf1[fsdf1['选项']==ty]
+        tmplist=list(tmpdf['指标'])
+        dictlist[ty]=tmplist
+        
+    """
+    # 手工设定项目显示顺序，使其看起来更合理
+    typedict={'规模指标': [
+              '总资产(亿元)',
+              '短期股票投资(亿元)','短期债券投资(亿元)','短期其它经营性投资(亿元)',
+              '长期股票投资(亿元)','长期债券投资(亿元)','长期其它经营性投资(亿元)',
+              '主营业务利润(亿元)','扣除非经常性损益后的净利润(亿元)',
+              ],
+        
+              '利润回报': [
+              '销售毛利率(%)','主营业务利润率(%)','营业利润率(%)','销售净利率(%)','成本费用利润率(%)',  
+              '主营业务成本率(%)','三项费用比重(%)',
+              '主营利润比重(%)','非主营比重(%)','固定资产比重(%)',
+              '总资产利润率(%)','总资产净利润率(%)','资产报酬率(%)',
+              '净资产收益率(%)','加权净资产收益率(%)','净资产报酬率(%)','投资收益率(%)','股本报酬率(%)','股息发放率(%)',
+              '总资产增长率(%)','净资产增长率(%)','主营业务收入增长率(%)','净利润增长率(%)',
+              ],
+             
+             '每股指标': [
+              '加权每股收益(元)','扣除非经常性损益后的每股收益(元)','摊薄每股收益(元)','每股收益_调整后(元)',
+              '每股净资产_调整前(元)','每股净资产_调整后(元)',#'调整后的每股净资产(元)',
+              '每股未分配利润(元)','每股资本公积金(元)',
+              '每股经营性现金流(元)',
+              ],
+             
+             '营运能力': [
+              '总资产周转率(次)','总资产周转天数(天)',   
+              '应收账款周转率(次)','应收账款周转天数(天)',
+              '存货周转率(次)','存货周转天数(天)',
+              '流动资产周转率(次)','流动资产周转天数(天)',
+              '固定资产周转率(次)',
+              '股东权益周转率(次)'
+              ],
+             
+             '现金指标': [
+              '现金流量比率(%)',   
+              '经营现金净流量对销售收入比率(%)',
+              '资产的经营现金流量回报率(%)',
+              '经营现金净流量与净利润的比率(%)',
+              ],
+             
+             '偿债能力': [
+              '流动比率','速动比率','现金比率(%)','利息支付倍数',
+              '资产负债率(%)','长期负债比率(%)','股东权益比率(%)','产权比率(%)','负债与所有者权益比率(%)',
+              '长期债务与营运资金比率(%)','股东权益与固定资产比率(%)','清算价值比率(%)',
+              '经营现金净流量对负债比率(%)'],
+             
+             '应收账款': [
+              '1年以内应收帐款(亿元)','1-2年以内应收帐款(亿元)',
+              '2-3年以内应收帐款(亿元)','3年以内应收帐款(亿元)',
+              '1年以内其它应收款(亿元)','1-2年以内其它应收款(亿元)',
+              '2-3年以内其它应收款(亿元)','3年以内其它应收款(亿元)'],
+             
+             '预付账款': [
+              '1年以内预付货款(亿元)','1-2年以内预付货款(亿元)', 
+              '2-3年以内预付货款(亿元)','3年以内预付货款(亿元)'],
+             
+             '其他指标': [
+              '长期资产与长期资金比率(%)', 
+              '资本化比率(%)', 
+              '固定资产净值率(%)', 
+              '资本固定化比率(%)']}
+    
+    # 注释
+    notesdict={'规模指标': \
+               '\n注：\n'+ \
+               '1. 短期=一年以内，长期=一年以上 \n'+ \
+               '2. 非经常性损益=非经常性或偶然活动带来的损益，一般不可持续。 \n', \
+              
+              '利润回报': \
+               '\n注：\n'+ \
+               '1. 销售毛利率=毛利率=毛利润/营业(总)收入*100%，毛利润=营业(总)收入-营业(总)成本 \n'+ \
+               '2. 主营业务利润率=主营业务利润/主营业务收入*100%，主营业务利润=主营业务收入-主营业务成本-主营业务税金及附加 \n'+ \
+               '3. 营业利润率=营业利润/营业(总)收入*100%，营业利润=主营业务利润+其他业务利润-期间费用+其他损益 \n'+ \
+               '4. 其他业务利润=其他业务收入-其它业务支出-其他业务税金及附加，期间费用=销售费用+管理费用+财务费用 \n'+ \
+               '5. 其他损益=-资产减值损失+公允价值变动损益(损失为负数)+投资损益(损失为负数)+资产处置损益(损失为负数) \n'+ \
+               '6. 利润总额=营业利润+营业外收入-营业外支出 \n'+ \
+               '7. 销售净利率=净利润率=净利润/营业(总)收入*100%，净利润=利润总额-所得税费用 \n'+ \
+               '8. 成本费用利润率=利润总额/成本费用总额*100%，成本费用总额=营业(总)成本+营业税金及附加+期间费用+资产减值损失 \n'+ \
+               '9. 主营业务收入成本率=主营业务成本/主营业务收入*100% \n'+ \
+               '10.三项费用比重=(管理费用+营业费用+财务费用)/营业(总)收入*100% \n'+ \
+               '11.主营利润比重=主营业务利润/利润总额×100% \n'+ \
+               '12.非主营比重=非主营业务利润/利润总额×100% \n'+ \
+               '13.固定资产比重=固定资产/资产总额*100% \n'+ \
+               '14.总资产利润率=利润总额/资产总额*100%，总资产净利润率(ROA)=净利润/资产总额*100% \n'+ \
+               '15.资产报酬率=息税前利润/资产总额*100%，息税前利润(EBIT)=净利润+所得税费用+利息费用 \n'+ \
+               '16.净资产收益率(ROE)=净利润/净资产*100%，净资产=资产总额-负债总额 \n'+ \
+               '17.加权净资产收益率=净利润/加权平均净资产*100%，加权平均净资产含期间内净资产增减(如发新股、债转股或分红)情况 \n'+ \
+               '18.净资产报酬率=息税前利润/加权平均净资产*100% \n'+ \
+               '19.投资报酬率=投资回报率(ROI)=利润总额/投资总额*100%，投资总额=短期投资+长期投资 \n'+ \
+               '20.股本报酬率=净利润/股东股本总数*100%，相当于股东股本按面值1元计算 \n'+ \
+               '21.股息发放率=股利支付率=股利/净利润*100%，反映公司的股利分配政策，比例高表明公司不需更多的资金进行再投入。 \n', \
+
+              '每股指标': \
+               '\n注：\n'+ \
+               '1. 每股收益=净利润/流通股数量，其中流通股数量按期初期末均值计算 \n'+ \
+               '2. 扣除非经常性损益后的每股收益=扣除非经常性损益后的净利润/流通股数量 \n'+ \
+               '3. 加权每股收益=净利润/加权流通股数量，加权流通股数量含期间内流通股数量的变化(增发新股、送股、转增股本或配股等) \n'+ \
+               '4. 摊薄每股收益=净利润/期末流通股数量 \n'+ \
+               '5. 调整后每股收益=调整后净利润/流通股数量，其中调整后净利润考虑了长期账龄的应收款项成为呆坏账对净利润的影响 \n'+ \
+               '6. 稀释后每股收益=净利润/稀释后流通股数量，假设企业的可转债、认股权证、股票期权等期间内均转换为普通股的情形 \n'+ \
+               '7. 每股净资产(调整前)=净资产/流通股数量，调整后指标考虑了净资产的流动性和变现能力，扣除了长期应收款项和(长期)待摊费用 \n'+ \
+               '8. 每股未分配利润=未分配利润/流通股数量，未分配利润指净利润经过弥补亏损、提取盈余公积和分红后留存在企业的利润累积 \n'+ \
+               '9. 每股资本公积金=资本公积金/流通股数量，资本公积金含发行股份的溢价、资产重估增值、接受捐赠等，仅可用于转增股本。 \n', \
+              
+              '营运能力': 
+               '\n注：\n'+ \
+               '1. 指标周转率/周转次数：营业(总)收入 / 指标的起初期末均值，从企业自身角度来说越大越好，但若涉及供应商则可能相反 \n'+ \
+               '2. 指标周转天数：360/周转率(或周转次数)，从企业自身角度来说越小越好，但若涉及供应商则可能相反 \n'+ \
+               '3. 注意：本表指标主要针对非金融行业，部分指标不适用于金融行业。 \n', \
+              
+              '现金指标':
+               '\n注：\n'+ \
+               '1. 现金流量比率=经营活动产生的现金净流量/期末流动负债*100%，反映企业短期偿债能力 \n'+ \
+               '2. 经营现金净流量对销售收入比率=销售现金比率，与赊销政策有关，若企业有虚假收入，也会使该指标过低 \n'+ \
+               '3. 资产的经营现金流量回报率=经营现金流量净额/总资产*100%,体现企业经营活动的收现能力 \n'+ \
+               '4. 经营现金净流量与净利润的比率=净现比=经营现金流量净额/净利润*100%。比率越大,企业盈利质量越高。 \n',
+               
+              '偿债能力':
+               '\n注：\n'+ \
+               '1. 流动比率=流动资产/流动负债，反映企业的短期偿债能力，属于宽松指标 \n'+ \
+               '2. 速动比率=(流动资产-存货)/流动负债，反映企业的短期偿债能力，属于较严的指标 \n'+ \
+               '3. 现金比率=(货币资金+短期有价证券)/流动负债*100%，反映企业的短期偿债能力，属于严厉的指标 \n'+ \
+               '4. 利息支付倍数=利息保障倍数=税息前利润/利息费用*100%，衡量偿付借款利息的能力 \n'+ \
+               '5. 长期负债比率=资本化比率=长期负债/资产总额*100% \n'+ \
+               '6. 股东权益比率=自有资本比率=净资产比率=股东权益/资产总额*100% \n'+ \
+               '7. 产权比率=长期负债/所有者权益(股东权益)*100% \n'+ \
+               '8. 长期债务与营运资金比率=长期债务/营运资金*100%，反映偿还债务能力，通常长期债务不应超过营运资金 \n'+ \
+               '9. 营运资金=流动资产-流动负债 \n'+ \
+               '10. 股东权益与固定资产比率=股东权益总额÷固定资产总额×100%，衡量公司财务结构稳定性，越大越稳定 \n'+ \
+               '11. 清算价值比率=有形资产/负债总额*100%，反映公司清偿全部债务的能力 \n'+ \
+               '12. 经营现金净流量对负债比率=现金流量负债比=经营活动现金流量净额/负债总额*100%，比率越高，财务弹性越好。 \n',
+              
+              '应收账款':
+               '\n注：\n'+ \
+               '1. 使用账龄法对应收账款/其他应收款分类 \n'+ \
+               '2. 一般而言，应收款项的账龄越长，成为呆坏账的可能性就越大。 \n',
+              
+              '预付账款':
+               '\n注：\n'+ \
+               '1. 一般而言，预付款项数额越大，企业在供应链中的地位越低 \n'+ \
+               '2. 一般而言，预付款项的账龄越长，企业在供应链中的地位越低。 \n',
+              
+              '其他指标':
+                '\n注：\n'+ \
+               '1. 长期资产与长期资金比率=非流动资产/(长期负债+股东权益)*100%，长期资金少，流动负债较多，财务风险较大 \n'+ \
+               '2. 资本化比率=长期负债/(长期负债+股东权益)*100%，指标值越小，负债的资本化程度就越低，长期偿债压力就越小 \n'+ \
+               '3. 固定资产净值率=(固定资产原值-累计折旧)/固定资产原值*100%，反映企业全部固定资产平均新旧程度 \n'+ \
+               '4. 资本固定化比率=非流动资产/净资产*100%，若超过100%，说明固定资产资金投入超过自身能力，易造成财务状况恶化。 \n',
+              }        
+        
+    # 一只股票情形：多日期
+    if len(tickers_found) == 1:
+        ticker1=tickers[0]
+        titletxt="\n===== 上市公司主要财务比率和重要指标："+codetranslate(ticker1)+" ====="    
+        print(titletxt)    
+        
+        fsdf1=fsdf[fsdf['ticker']==ticker1]
+        for ty in typelist:
+            dft=fsdf1[fsdf1['选项']==ty]
+            #print(list(dft['指标']))
+            
+            # 自定义排序
+            try:
+                tmplist=typedict[ty]
+                dft2=dft[dft['指标'].isin(tmplist)]
+                
+                tmplist2=sorted(list(set(tmplist)),key=tmplist.index)
+                dft2["指标"]=dft2["指标"].astype('category').cat.set_categories(tmplist2)
+            except:
+                print("#set_categories error",ty)
+                print(typedict[ty])
+                pass
+            
+            dft2.sort_values(by='指标',inplace=True)
+            
+            dft2.reset_index(drop=True,inplace=True)
+            dft2.index=dft2.index + 1
+            dft3=dft2.drop(labels=['选项','ticker'],axis=1)
+            
+            print("\n***",ty+'：')
+            colalign=['center','left']+['right']*(len(list(dft3)) - 1)
+            print(dft3.to_markdown(tablefmt='Simple',index=True,colalign=colalign))
+            print(notesdict[ty])
+        
+        return dft3
+            
+    # 多只股票情形：单日期
+    if len(tickers_found) > 1:
+    
+        import pandas as pd
+        fsdates2=[]
+        for fsd in fsdates:
+            fsd2=pd.to_datetime(fsd)
+            fsd3=fsd2.strftime("%Y-%m-%d")
+            fsdates2=fsdates2+[fsd3]
+        fsdates3=sorted(fsdates2,reverse=True)                
+    
+        mdf=pd.DataFrame()
+        for t in tickers_found:
+            dft=fsdf[fsdf['ticker']==t]
+            
+            try:
+                dft2=dft[['选项','指标',fsdates3[0]]]
+                dft2.rename(columns={fsdates3[0]:codetranslate(t)},inplace=True)
+            except:
+                print("  #Error(compare_fin_summary_china): fin stmt of",fsdates3[0],'not found for',t)
+                return None
+            
+            if len(mdf) == 0:
+                mdf=dft2
+            else:
+                mdf=mdf.merge(dft2,how='outer',left_on=['选项','指标'], right_on=['选项','指标'])
+        
+        titletxt="\n===== 上市公司财务报表主要比率和重要项目对比：报表日期"+fsdates3[0]+" ====="
+        print('\n'+titletxt)    
+        
+        for ty in typelist:
+            dft=mdf[mdf['选项']==ty]
+            
+            # 自定义排序
+            tmplist=typedict[ty]
+            dft2=dft[dft['指标'].isin(tmplist)]
+            
+            tmplist2=sorted(list(set(tmplist)),key=tmplist.index)
+            dft2["指标"]=dft2["指标"].astype('category').cat.set_categories(tmplist2)
+            dft2.sort_values(by='指标',inplace=True)
+            
+            dft2.reset_index(drop=True,inplace=True)
+            dft2.index=dft2.index + 1
+            dft3=dft2.drop(labels=['选项'],axis=1)
+            
+            print("\n***",ty+'：')
+            colalign=['center','left']+['right']*(len(list(dft3)) - 1)
+            print(dft3.to_markdown(tablefmt='Simple',index=True,colalign=colalign))
+            print(notesdict[ty])
+    
+        return dft3
+
+#==============================================================================
+#==============================================================================
+#==============================================================================
 #==============================================================================
```

## siat/sector_china.py

```diff
@@ -873,15 +873,16 @@
     打印申万行业的成分股，名称(代码)
     """
     
     icode=industry_sw_code(iname)
     
     clist,cdf=industry_stock_sw(icode,top=1000)    
 
-    cdf['icode']=cdf['证券代码'].apply(lambda x: x+'.SS' if x[:1] in ['6'] else (x+'.SZ' if x[:1] in ['0','3'] else x+'.BJ' ))
+    #cdf['icode']=cdf['证券代码'].apply(lambda x: x+'.SS' if x[:1] in ['6'] else (x+'.SZ' if x[:1] in ['0','3'] else x+'.BJ' ))
+    cdf['icode']=cdf['证券代码']
     
     # 删除'证券名称'为None的行
     cdf=cdf.mask(cdf.eq('None')).dropna()
     cdf['name_code']=cdf.apply(lambda x: x['证券名称']+'('+x['icode']+')',axis=1)
     
     ilist=list(cdf['name_code'])
     import datetime as dt; stoday=dt.date.today()    
@@ -904,15 +905,16 @@
     打印申万行业的成分股，名称(代码)
     输入：申万行业代码，一二三级均可
     """
     iname=industry_sw_name(icode)
     
     clist,cdf=industry_stock_sw(icode,top=1000)    
 
-    cdf['icode']=cdf['证券代码'].apply(lambda x: x+'.SS' if x[:1] in ['6'] else (x+'.SZ' if x[:1] in ['0','3'] else x+'.BJ' ))
+    #cdf['icode']=cdf['证券代码'].apply(lambda x: x+'.SS' if x[:1] in ['6'] else (x+'.SZ' if x[:1] in ['0','3'] else x+'.BJ' ))
+    cdf['icode']=cdf['证券代码']
     
     # 删除'证券名称'为None的行
     cdf=cdf.mask(cdf.eq('None')).dropna()
     cdf['name_code']=cdf.apply(lambda x: x['证券名称']+'('+x['icode']+')',axis=1)
     
     ilist=list(cdf['name_code'])
     import datetime as dt; stoday=dt.date.today()    
@@ -2033,15 +2035,15 @@
             print("  #Warning(industry_stock_sw): industry code not found for",industry)
             return None
     
     import akshare as ak
     try:
         cdf = ak.index_component_sw(industry)
     except:
-        print("  #Warning(industry_stock_sw): industry code not found",industry)
+        print("  #Warning(industry_stock_sw): fetching index component failed or code not found",industry)
         return None
 
     # 删除'证券名称'为None的行
     cdf=cdf.mask(cdf.eq('None')).dropna()
 
     #排名
     cdf.sort_values(by='最新权重',ascending=False,inplace=True)
```

## Comparing `siat-1.9.7.dist-info/METADATA` & `siat-2.0.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: siat
-Version: 1.9.7
+Version: 2.0
 Summary: Securities Investment Analysis Tools (siat)
 Home-page: https://pypi.org/project/siat/
 Author: Prof. WANG Dehong, Business School, BFSU (北京外国语大学 国际商学院 王德宏 教授)
 Author-email: wdehong2000@163.com
 License: Copyright (C) WANG Dehong, 2023. For educational purpose only!
 Platform: UNKNOWN
 Requires-Dist: pandas-datareader
```

## Comparing `siat-1.9.7.dist-info/RECORD` & `siat-2.0.dist-info/RECORD`

 * *Files 1% similar despite different names*

```diff
@@ -30,15 +30,15 @@
 siat/esg_test.py,sha256=Z9m6GUt8O7oHZSEG9aDYpGdvvrv2AiRJdHTiU6jqmZ0,2944
 siat/fama_french.py,sha256=qDpsZOj0BLuzXXdNwJ1IPhDyNVAnTJFHqn80Hkp85ZI,47177
 siat/fama_french_test.py,sha256=M4O23lBKsJxhWHRluwCb3l7HSEn3OFTjzGMpehcevRg,4678
 siat/financial_base.py,sha256=YxNVfhbgLQ4stLojI9nklB4sdQNuROcILcO3M2uz4Gs,40695
 siat/financial_statements.py,sha256=KDUl9b92EV5IseLLnEmG3czDHAaay2SWM2MpzZXPHpk,21528
 siat/financial_statements_test.py,sha256=FLhx8JD-tVVWSBGux6AMz1jioXX4U4bp9DmgFHYXb_w,716
 siat/financials.py,sha256=4b0fJAu1Mm5aX_zCIvF01CzzBokrprQpIk1N3za1FNA,76676
-siat/financials_china.py,sha256=QLHbnRRq-n9uU32OUZ-Q8KUR2m6UiwyERmyx7kEcOmA,149838
+siat/financials_china.py,sha256=bHo8-nBG2HAdg_sugzcA9yO_FdBP4WP-XpBeoeyepQo,173655
 siat/financials_china2.py,sha256=NKYsPOp36qGBT0qt7TwlRIcu-FE8CoKifYWjTwDHgaw,60037
 siat/financials_china2_test.py,sha256=Erz5k4LyOplBBvYls2MypuqHpVNJ3daiLdyeJezNPu0,2722
 siat/financials_china2_test2.py,sha256=C8CuYTMHN4Mhp-sTu-Bmg0zMXRCaYV6ezGDoYartRYQ,3507
 siat/financials_china2_test3.py,sha256=UXYSA80DNSPRhHpovc2MA9JkpILWMAQaRatbWCHBNPs,3118
 siat/financials_china_test.py,sha256=QS1SD_mXx4uH1Lg3gl2PmwLrvkLqkRs3e4x7SyFI_Xk,17549
 siat/financials_china_test2.py,sha256=WkNlVW_0hGegdw1rzg4BP_dKR-smdyUp9Fr00K7mPZY,5924
 siat/financials_china_test2_fin_indicator.py,sha256=WkNlVW_0hGegdw1rzg4BP_dKR-smdyUp9Fr00K7mPZY,5924
@@ -74,15 +74,15 @@
 siat/quandl_test.py,sha256=EcPoXnLuqzPl5dKyVEZi3j3PJZFpsnU_iNPhLWC9p-A,1552
 siat/risk_adjusted_return.py,sha256=8vyjOCap9xEvWIpJnBEsDm8Ba3CD9QrEXy2qFG6zvVk,49073
 siat/risk_adjusted_return_test.py,sha256=m_VHL5AtT74cJv5i7taTeTfnkX48y0AFJk5phawyYWg,3416
 siat/risk_evaluation.py,sha256=lCDqCaSEppH0MFPFg-P14IYcF3IJqILbPfDmzf_AfcY,75061
 siat/risk_evaluation_test.py,sha256=YEXM96gKzTfwN4U61AS4Rr1tV7KgUvn4rRC6f3iMw9s,3731
 siat/risk_free_rate.py,sha256=r62zCl1qbI4lJU17GsgM-OmVx9oo3dltXeZVCNd6Uxg,12304
 siat/risk_free_rate_test.py,sha256=CpmhUf8aEAEZeNu4gvWP2Mz2dLoIgBX5bI41vfUBEr8,4285
-siat/sector_china.py,sha256=P8R1fdeDy-CjS3SaHTN2V_tEqMod8a4zmiLCSQhPQiQ,99980
+siat/sector_china.py,sha256=0JFs5wXZXOu5tuGnFXKBuR4TVIGqvP_W4psQAAAjW-M,100084
 siat/sector_china_test.py,sha256=1wq7ef8Bb_L8F0h0W6FvyBrIcBTEbrTV7hljtpj49U4,5843
 siat/security_price.py,sha256=ibrdUJyt_n0c8oKRbVStE1_ptmWkzy4YIHjpc_fGiPQ,29148
 siat/security_prices.py,sha256=Xl7EHz16qCUIzuPGpEi-g-tLGQKk3MqHmic556-Vs7U,71984
 siat/security_prices_test.py,sha256=OEphoJ87NPKoNow1QA8EU_5MUYrJF-qKoWKNapVfZNI,10779
 siat/setup.py,sha256=up65rQGLmTBkhtaMLowjoQXYmIsnycnm4g1SYmeQS6o,1335
 siat/shenwan index history test.py,sha256=JCVAzOSEldHalhSFa3pqD8JI_8_djPMQOxpkuYU-Esg,1418
 siat/stock.py,sha256=kW_R_CW9WbR0bzwwUlFwvWh0oJE3zA8gfKw_AJUWfCo,117254
@@ -107,11 +107,11 @@
 siat/translate-20230206.py,sha256=-vtI125WyaJhmPotOpDAmclt_XnYVaWU9ByLWZ6FyYE,118133
 siat/translate-20230215.py,sha256=TJgtPE3n8IjljmZ4Pefy8dmHoNdFF-1zpML6BhA9FKE,121657
 siat/translate.py,sha256=Ed3H3G1BiMaWL1iKGiiE4YP92tgj23xhlIdsU42Uqlk,124748
 siat/universal_test.py,sha256=CDAOffW1Rvs-TcNN5giWVvHMlch1w4dp-w5SIV9jXL0,3936
 siat/valuation_china.py,sha256=J78FTnwyzOjNENq30MXaQdby6EtcBZi3AMeUKhGtuok,51268
 siat/valuation_market_china_test.py,sha256=gbJ0ioauuo4koTPH6WKUkqcXiQPafnbhU5eKJ6lpdLA,1571
 siat/var_model_validation.py,sha256=zB_Skk_tmzIR15l6oAW3am4HBGVIG-eZ8gJhCdXZ8Qw,14859
-siat-1.9.7.dist-info/METADATA,sha256=4RumbDKcYiFMtG06bDVtDUgOLcPfyY_LGBqS6HAqFQw,1399
-siat-1.9.7.dist-info/WHEEL,sha256=ewwEueio1C2XeHTvT17n8dZUJgOvyCWCt0WVNLClP9o,92
-siat-1.9.7.dist-info/top_level.txt,sha256=r1cVyL7AIKqeAmEJjNR8FMT20OmEzufDstC2gv3NvEY,5
-siat-1.9.7.dist-info/RECORD,,
+siat-2.0.dist-info/METADATA,sha256=RLRwoVtxEgkdjPtC84be5P5At8kKuc2_P5WG9RxSqZQ,1397
+siat-2.0.dist-info/WHEEL,sha256=ewwEueio1C2XeHTvT17n8dZUJgOvyCWCt0WVNLClP9o,92
+siat-2.0.dist-info/top_level.txt,sha256=r1cVyL7AIKqeAmEJjNR8FMT20OmEzufDstC2gv3NvEY,5
+siat-2.0.dist-info/RECORD,,
```

